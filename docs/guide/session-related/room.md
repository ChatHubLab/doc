# 房间系统

ChatLuna V1 版本中最重要的无疑是房间系统。房间系统提供了多种多样的聊天功能。

通过房间系统，可以实现：

* 每个用户默认单独的对话
* 群组内共享对话
* 使用模板克隆房间，群组内模型同步更新
* 创建私人对话，邀请他人一起聊，多人同步在一个房间里
* 切换房间，实现模型和预设的快速切换

让我们开始了解房间系统吧！

## 房间类型

在 ChatLuna 中，房间分为三种类型：

* 公共房间（Public）
* 私人房间（Private）
* 模板克隆房间（Template Clone）

### 模板克隆房间

为了让 ChatLuna 更简单易用，ChatLuna 特意设计了模板克隆房间：

模板克隆房间是具有以下特性：

* 默认群聊情况下，所有人默认都进入这个模板克隆房间
* 每个群只能含有一个模板克隆房间
* 可以在主插件的 [设置](../useful-configurations.md#模版房间选项) 里直接配置模板房间的模型，聊天模式和预设。

模板克隆房间适用于新手的快速对话。

### 公共房间

公共房间是 ChatLuna 中新建房间时使用的类型。

公共房间具有以下特性：

* 在群聊里，每个用户首次聊天时，会自动进入公共房间。（如果模板房间不存在）
* 所有用户都可以加入公共房间
* 公共房间支持跨群（存疑）

公共房间适用于默认群聊的环境。（即群友们和 Bot 对话，Bot 能维持和他们所有人的上下文）

### 私人房间

私人房间具有以下特性：

* 私人房间支持通过邀请加入
* 私人房间支持设置密码，加入时需要输入密码
* 私人房间支持跨群使用

私人房间适用于需要隔离上下文，创建一个不干扰的对话环境。

## 使用方式

由于房间系统的独特设计，你可以选择不同的方式来使用房间系统。

### 群内统一上下文，模型与预设 <Badge text="推荐" type="tip" vertical="middle" />

此方式基本适用于所有部署 ChatLuna 的用户，并且也是最方便的使用方式。

只需要在主插件的 [设置](../useful-configurations.md#模版房间选项) 里直接配置模板房间的模型，聊天模式和预设即可。

ChatLuna 会自动在群内创建一个模板克隆房间，并且所有人默认进入这个模板克隆房间。

所有的模版克隆房间都会共享同一个模型，同一个预设，同一个聊天模式。

### 群内单独上下文，统一模型和预设

此方式适用于需要在群内每位群友独立上下文的用户。

和上一种方式类似，配置好模板房间的模型，聊天模式和预设即可。

但还需要打开 [为每个用户单独创建房间](../useful-configurations.md#autocreateroomfromuser) 选项。

开启后，用户在所有的群聊和私聊都将会默认使用创建的私有房间。

### 在不同的群内使用不同的模型和预设

> [!TIP] 提示
> 此方式暂时不支持单独上下文，在群内的用户都只能使用同一个房间。
> 此方式的原理是：群聊里没有模版克隆房间时，会寻找公共房间并自动加入。

此方式较为复杂，需要使用几条命令来完成。

1. 在目标群聊里新建一个公共房间，参考 [创建房间](../useful-commands.md#创建房间) 命令。
2. 在目标群聊删除已有的模版克隆房间，参考 [删除房间](../useful-commands.md#删除房间) 命令。

完成！接下来在群聊里就可以正常的使用该公共房间了。

### 个人单独创建房间，隔离上下文

此方式适用于一些特殊的用户。

类似上一种方式，需要使用几条命令来完成。

1. 在目标群聊里新建一个私有房间，参考 [创建房间](../useful-commands.md#创建房间) 命令。
2. 在目标群聊里切换到该房间，参考 [切换房间](../useful-commands.md#切换房间) 命令。

完成！接下来在群聊里就可以正常的使用该房间了。

私有房间也支持跨群和私聊对话。这意味着你可以在不同的群聊和私聊里使用同一个房间。

## 自动更新

你可以执行 [自动更新房间](../useful-commands.md#设置自动更新) 命令。

当设置的值为 `true` 时，ChatLuna 会自动将房间里的模型，预设和聊天模式更新为模板房间的设置。

此命令适用于所有的房间类型。
